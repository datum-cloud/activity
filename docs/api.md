# API Reference

## Packages
- [activity.miloapis.com/v1alpha1](#activitymiloapiscomv1alpha1)


## activity.miloapis.com/v1alpha1

Package v1alpha1 contains API Schema definitions for the activity v1alpha1 API group










#### Activity



Activity represents a single translated activity record. Activities are
generated by the Activity Processor from audit logs and Kubernetes events
using ActivityPolicy rules. They provide human-readable summaries of
resource changes for consumers, service providers, and platform administrators.


Activities are read-only and stored in ClickHouse for efficient time-range queries.
Use List and Get operations to query activities. Watch is supported for real-time updates.



_Appears in:_
- [ActivityList](#activitylist)
- [PolicyPreviewStatus](#policypreviewstatus)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `metadata` _[ObjectMeta](https://kubernetes.io/docs/reference/generated/kubernetes-api/v/#objectmeta-v1-meta)_ | Refer to Kubernetes API documentation for fields of `metadata`. |  |  |
| `spec` _[ActivitySpec](#activityspec)_ |  |  |  |


#### ActivityActor



ActivityActor identifies who performed an action.



_Appears in:_
- [ActivitySpec](#activityspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `type` _string_ | Type indicates the actor category.<br />Values: "user", "serviceaccount", "controller" |  |  |
| `name` _string_ | Name is the display name for the actor.<br />For users, this is typically the email address.<br />For service accounts, this is the full name (e.g., "system:serviceaccount:default:my-sa").<br />For controllers, this is the controller name. |  |  |
| `uid` _string_ | UID is the unique identifier for the actor.<br />Stable across username changes. |  |  |
| `email` _string_ | Email is the actor's email address.<br />Only populated for user actors when available. |  |  |


#### ActivityChange



ActivityChange represents a field-level change in an update/patch operation.



_Appears in:_
- [ActivitySpec](#activityspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `field` _string_ | Field is the path to the changed field (e.g., "spec.virtualhost.fqdn"). |  |  |
| `old` _string_ | Old is the previous value. May be empty for new fields. |  |  |
| `new` _string_ | New is the new value. May be empty for deleted fields. |  |  |




#### ActivityFacetQuerySpec



ActivityFacetQuerySpec defines which facets to retrieve.



_Appears in:_
- [ActivityFacetQuery](#activityfacetquery)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `timeRange` _[FacetTimeRange](#facettimerange)_ | TimeRange limits the time window for facet aggregation.<br />If not specified, defaults to the last 7 days. |  |  |
| `filter` _string_ | Filter narrows the activities before computing facets using CEL.<br />This allows you to get facet values for a subset of activities.<br /><br />Available Fields:<br />  spec.changeSource              - "human" or "system"<br />  spec.actor.name                - actor display name<br />  spec.actor.type                - actor type (user, serviceaccount, controller)<br />  spec.actor.uid                 - actor UID<br />  spec.resource.apiGroup         - resource API group<br />  spec.resource.kind             - resource kind<br />  spec.resource.name             - resource name<br />  spec.resource.namespace        - resource namespace<br />  spec.summary                   - activity summary text<br />  spec.origin.type               - origin type (audit, event)<br />  metadata.namespace             - activity namespace<br /><br />Operators: ==, !=, &&, \|\|, !, in<br />String Functions: startsWith(), endsWith(), contains()<br /><br />Examples:<br />  "spec.changeSource == 'human'"                     - Human actions only<br />  "!(spec.changeSource == 'system')"                 - Exclude system actions<br />  "spec.resource.kind == 'Deployment'"               - Deployment activities<br />  "!spec.actor.name.startsWith('system:')"           - Exclude system actors |  |  |
| `facets` _[FacetSpec](#facetspec) array_ | Facets specifies which fields to get distinct values for.<br />Each facet returns the top N values with counts. |  |  |


#### ActivityFacetQueryStatus



ActivityFacetQueryStatus contains the facet results.



_Appears in:_
- [ActivityFacetQuery](#activityfacetquery)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `facets` _[FacetResult](#facetresult) array_ | Facets contains the results for each requested facet. |  |  |


#### ActivityLink



ActivityLink represents a clickable reference in an activity summary.



_Appears in:_
- [ActivitySpec](#activityspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `marker` _string_ | Marker is the text substring in the summary that should be linked.<br />The portal scans the summary for this marker and makes it clickable.<br /><br />Example: "HTTP proxy api-gateway" |  |  |
| `resource` _[ActivityResource](#activityresource)_ | Resource identifies what the marker links to. |  |  |




#### ActivityOrigin



ActivityOrigin identifies the source record for an activity.



_Appears in:_
- [ActivitySpec](#activityspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `type` _string_ | Type indicates the source type.<br />Values: "audit" (from audit logs), "event" (from Kubernetes events) |  |  |
| `id` _string_ | ID is the correlation ID to the source record.<br />For audit: the auditID from the audit log entry.<br />For event: the metadata.uid of the Kubernetes Event. |  |  |


#### ActivityPolicy



ActivityPolicy defines translation rules for a specific resource type. Service providers
create one ActivityPolicy per resource kind to customize activity descriptions without
modifying the Activity Processor.


Example:


	apiVersion: activity.miloapis.com/v1alpha1
	kind: ActivityPolicy
	metadata:
	  name: networking-httpproxy
	spec:
	  resource:
	    apiGroup: networking.datumapis.com
	    kind: HTTPProxy
	  auditRules:
	    - match: "audit.verb == 'create'"
	      summary: "{{ actor }} created {{ link(kind + ' ' + audit.objectRef.name, audit.responseObject) }}"
	  eventRules:
	    - match: "event.reason == 'Programmed'"
	      summary: "{{ link(kind + ' ' + event.regarding.name, event.regarding) }} is now programmed"



_Appears in:_
- [ActivityPolicyList](#activitypolicylist)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `metadata` _[ObjectMeta](https://kubernetes.io/docs/reference/generated/kubernetes-api/v/#objectmeta-v1-meta)_ | Refer to Kubernetes API documentation for fields of `metadata`. |  |  |
| `spec` _[ActivityPolicySpec](#activitypolicyspec)_ |  |  |  |
| `status` _[ActivityPolicyStatus](#activitypolicystatus)_ |  |  |  |




#### ActivityPolicyResource



ActivityPolicyResource identifies the target Kubernetes resource for a policy.



_Appears in:_
- [ActivityPolicySpec](#activitypolicyspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `apiGroup` _string_ | APIGroup is the API group of the target resource (e.g., "networking.datumapis.com").<br />Use an empty string for core API group resources. |  |  |
| `kind` _string_ | Kind is the kind of the target resource (e.g., "HTTPProxy", "Network"). |  |  |


#### ActivityPolicyRule



ActivityPolicyRule defines a single translation rule that matches input events
and generates human-readable activity summaries.



_Appears in:_
- [ActivityPolicySpec](#activitypolicyspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `match` _string_ | Match is a CEL expression that determines if this rule applies to the input.<br />For audit rules, use the `audit` variable (e.g., "audit.verb == 'create'").<br />For event rules, use the `event` variable (e.g., "event.reason == 'Programmed'").<br /><br />Examples:<br />  "audit.verb == 'create'"<br />  "audit.verb in ['update', 'patch']"<br />  "event.reason.startsWith('Failed')"<br />  "true"  (fallback rule that always matches) |  |  |
| `summary` _string_ | Summary is a CEL template for generating the activity summary.<br />Use \{\{ \}\} delimiters to embed CEL expressions within strings.<br /><br />Available variables:<br />  - audit/event: The full input object<br />  - actor: Resolved display name for the actor<br /><br />Available functions:<br />  - link(displayText, resourceRef): Creates a clickable reference<br /><br />Examples:<br />  "\{\{ actor \}\} created \{\{ link(kind + ' ' + audit.objectRef.name, audit.responseObject) \}\}"<br />  "\{\{ link(kind + ' ' + event.regarding.name, event.regarding) \}\} is now programmed" |  |  |


#### ActivityPolicySpec



ActivityPolicySpec defines the translation rules for a resource type.



_Appears in:_
- [ActivityPolicy](#activitypolicy)
- [PolicyPreviewSpec](#policypreviewspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `resource` _[ActivityPolicyResource](#activitypolicyresource)_ | Resource identifies the Kubernetes resource this policy applies to.<br />One ActivityPolicy should exist per resource kind. |  |  |
| `auditRules` _[ActivityPolicyRule](#activitypolicyrule) array_ | AuditRules define how to translate audit log entries into activity summaries.<br />Rules are evaluated in order; the first matching rule wins.<br />The `audit` variable contains the full Kubernetes audit event structure.<br />Convenience variables available: actor |  |  |
| `eventRules` _[ActivityPolicyRule](#activitypolicyrule) array_ | EventRules define how to translate Kubernetes events into activity summaries.<br />Rules are evaluated in order; the first matching rule wins.<br />The `event` variable contains the full Kubernetes Event structure.<br />Convenience variables available: actor |  |  |


#### ActivityPolicyStatus



ActivityPolicyStatus represents the current state of an ActivityPolicy.



_Appears in:_
- [ActivityPolicy](#activitypolicy)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `conditions` _[Condition](https://kubernetes.io/docs/reference/generated/kubernetes-api/v/#condition-v1-meta) array_ | Conditions represent the current state of the policy.<br />The "Ready" condition indicates whether all rules compile successfully. |  |  |
| `observedGeneration` _integer_ | ObservedGeneration is the generation last processed by the controller. |  |  |


#### ActivityResource



ActivityResource identifies the Kubernetes resource affected by an activity.



_Appears in:_
- [ActivityLink](#activitylink)
- [ActivitySpec](#activityspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `apiGroup` _string_ | APIGroup is the API group of the resource.<br />Empty string for core API group. |  |  |
| `apiVersion` _string_ | APIVersion is the API version of the resource. |  |  |
| `kind` _string_ | Kind is the kind of the resource. |  |  |
| `name` _string_ | Name is the name of the resource. |  |  |
| `namespace` _string_ | Namespace is the namespace of the resource.<br />Empty for cluster-scoped resources. |  |  |
| `uid` _string_ | UID is the unique identifier of the resource. |  |  |


#### ActivitySpec



ActivitySpec contains the translated activity details.



_Appears in:_
- [Activity](#activity)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `summary` _string_ | Summary is the human-readable description of what happened.<br />Generated from ActivityPolicy templates.<br /><br />Example: "alice created HTTP proxy api-gateway" |  |  |
| `changeSource` _string_ | ChangeSource indicates who initiated the change.<br />Used to filter human actions from system reconciliation noise.<br /><br />Values:<br />  - "human": User action via kubectl, API, or UI<br />  - "system": Controller reconciliation, operator actions, scheduled jobs |  |  |
| `actor` _[ActivityActor](#activityactor)_ | Actor identifies who performed the action. |  |  |
| `resource` _[ActivityResource](#activityresource)_ | Resource identifies the Kubernetes resource that was affected. |  |  |
| `links` _[ActivityLink](#activitylink) array_ | Links contains clickable references found in the summary.<br />The portal uses these to make resource names in the summary clickable. |  |  |
| `tenant` _[ActivityTenant](#activitytenant)_ | Tenant identifies the scope for multi-tenant isolation. |  |  |
| `changes` _[ActivityChange](#activitychange) array_ | Changes contains field-level changes for update/patch operations.<br />Shows old and new values for modified fields.<br /><br />NOTE: This field may be empty in the initial implementation.<br />Populating old values requires resource history lookups. |  |  |
| `origin` _[ActivityOrigin](#activityorigin)_ | Origin identifies the source record for correlation. |  |  |


#### ActivityTenant



ActivityTenant identifies the scope for multi-tenant isolation.



_Appears in:_
- [ActivitySpec](#activityspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `type` _string_ | Type is the scope level.<br />Values: "global", "organization", "project", "user" |  |  |
| `name` _string_ | Name is the tenant identifier within the scope type. |  |  |




#### AuditLogFacetsQuerySpec



AuditLogFacetsQuerySpec defines which facets to retrieve from audit logs.



_Appears in:_
- [AuditLogFacetsQuery](#auditlogfacetsquery)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `timeRange` _[FacetTimeRange](#facettimerange)_ | TimeRange limits the time window for facet aggregation.<br />If not specified, defaults to the last 7 days. |  |  |
| `filter` _string_ | Filter narrows the audit logs before computing facets using CEL.<br />This allows you to get facet values for a subset of audit logs.<br /><br />Available Fields:<br />  verb               - API action: get, list, create, update, patch, delete, watch<br />  user.username      - who made the request (user or service account)<br />  user.uid           - unique user identifier<br />  responseStatus.code - HTTP response code (200, 201, 404, 500, etc.)<br />  objectRef.namespace - target resource namespace<br />  objectRef.resource  - resource type (pods, deployments, secrets, configmaps, etc.)<br />  objectRef.apiGroup  - API group of the resource<br />  objectRef.name     - specific resource name<br /><br />Operators: ==, !=, <, >, <=, >=, &&, \|\|, !, in<br />String Functions: startsWith(), endsWith(), contains()<br /><br />Examples:<br />  "verb in ['create', 'update', 'delete']"        - Facets for write operations only<br />  "!(verb in ['get', 'list', 'watch'])"           - Exclude read-only operations<br />  "!user.username.startsWith('system:')"          - Exclude system users<br />  "objectRef.namespace == 'production'"           - Facets for production namespace |  |  |
| `facets` _[FacetSpec](#facetspec) array_ | Facets specifies which fields to get distinct values for.<br />Each facet returns the top N values with counts.<br /><br />Supported fields:<br />  - verb: API action (get, list, create, update, patch, delete, watch)<br />  - user.username: Actor display names<br />  - user.uid: Unique user identifiers<br />  - responseStatus.code: HTTP response codes<br />  - objectRef.namespace: Namespaces<br />  - objectRef.resource: Resource types<br />  - objectRef.apiGroup: API groups |  |  |


#### AuditLogFacetsQueryStatus



AuditLogFacetsQueryStatus contains the facet results.



_Appears in:_
- [AuditLogFacetsQuery](#auditlogfacetsquery)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `facets` _[FacetResult](#facetresult) array_ | Facets contains the results for each requested facet. |  |  |


#### AuditLogQuery



AuditLogQuery searches your control plane's audit logs.


Use this to investigate incidents, track resource changes, generate compliance reports,
or analyze user activity. Results are returned in the Status field, ordered newest-first.


Quick Start:


	apiVersion: activity.miloapis.com/v1alpha1
	kind: AuditLogQuery
	metadata:
	  name: recent-deletions
	spec:
	  startTime: "now-30d"       # last 30 days
	  endTime: "now"
	  filter: "verb == 'delete'" # optional: narrow your search
	  limit: 100


Time Formats:
- Relative: "now-30d" (great for dashboards and recurring queries)
- Absolute: "2024-01-01T00:00:00Z" (great for historical analysis)



_Appears in:_
- [AuditLogQueryList](#auditlogquerylist)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `metadata` _[ObjectMeta](https://kubernetes.io/docs/reference/generated/kubernetes-api/v/#objectmeta-v1-meta)_ | Refer to Kubernetes API documentation for fields of `metadata`. |  |  |
| `spec` _[AuditLogQuerySpec](#auditlogqueryspec)_ |  |  |  |
| `status` _[AuditLogQueryStatus](#auditlogquerystatus)_ |  |  |  |




#### AuditLogQuerySpec



AuditLogQuerySpec defines the search parameters.


Required: startTime and endTime define your search window.
Optional: filter (narrow results), limit (page size, default 100), continue (pagination).


Performance: Smaller time ranges and specific filters perform better. The maximum time window
is typically 30 days. If your range is too large, you'll get an error with guidance on splitting
your query into smaller chunks.



_Appears in:_
- [AuditLogQuery](#auditlogquery)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `startTime` _string_ | StartTime is the beginning of your search window (inclusive).<br /><br />Format Options:<br />- Relative: "now-30d", "now-2h", "now-30m" (units: s, m, h, d, w)<br />  Use for dashboards and recurring queries - they adjust automatically.<br />- Absolute: "2024-01-01T00:00:00Z" (RFC3339 with timezone)<br />  Use for historical analysis of specific time periods.<br /><br />Examples:<br />  "now-30d"                     → 30 days ago<br />  "2024-06-15T14:30:00-05:00"   → specific time with timezone offset |  |  |
| `endTime` _string_ | EndTime is the end of your search window (exclusive).<br /><br />Uses the same formats as StartTime. Commonly "now" for current moment.<br />Must be greater than StartTime.<br /><br />Examples:<br />  "now"                  → current time<br />  "2024-01-02T00:00:00Z" → specific end point |  |  |
| `filter` _string_ | Filter narrows results using CEL (Common Expression Language). Leave empty to get all events.<br /><br />Available Fields:<br />  verb               - API action: get, list, create, update, patch, delete, watch<br />  auditID            - unique event identifier<br />  requestReceivedTimestamp - when the API server received the request (RFC3339 timestamp)<br />  user.username      - who made the request (user or service account)<br />  user.uid           - unique user identifier (stable across username changes)<br />  responseStatus.code - HTTP response code (200, 201, 404, 500, etc.)<br />  objectRef.namespace - target resource namespace<br />  objectRef.resource  - resource type (pods, deployments, secrets, configmaps, etc.)<br />  objectRef.name     - specific resource name<br /><br />Operators: ==, !=, <, >, <=, >=, &&, \|\|, !, in<br />String Functions: startsWith(), endsWith(), contains()<br /><br />Common Patterns:<br />  "verb == 'delete'"                                    - All deletions<br />  "objectRef.namespace == 'production'"                 - Activity in production namespace<br />  "verb in ['create', 'update', 'delete', 'patch']"     - All write operations<br />  "!(verb in ['get', 'list', 'watch'])"                 - Exclude read-only operations<br />  "responseStatus.code >= 400"                          - Failed requests<br />  "user.username.startsWith('system:serviceaccount:')"  - Service account activity<br />  "!user.username.startsWith('system:')"                - Exclude system users<br />  "user.uid == '550e8400-e29b-41d4-a716-446655440000'"  - Specific user by UID<br />  "objectRef.resource == 'secrets'"                     - Secret access<br />  "verb == 'delete' && objectRef.namespace == 'production'" - Production deletions<br /><br />Note: Use single quotes for strings. Field names are case-sensitive.<br />CEL reference: https://cel.dev |  |  |
| `limit` _integer_ | Limit sets the maximum number of results per page.<br />Default: 100, Maximum: 1000.<br /><br />Use smaller values (10-50) for exploration, larger (500-1000) for data collection.<br />Use continue to fetch additional pages. |  |  |
| `continue` _string_ | Continue is the pagination cursor for fetching additional pages.<br /><br />Leave empty for the first page. If status.continue is non-empty after a query,<br />copy that value here in a new query with identical parameters to get the next page.<br />Repeat until status.continue is empty.<br /><br />Important: Keep all other parameters (startTime, endTime, filter, limit) identical<br />across paginated requests. The cursor is opaque - copy it exactly without modification. |  |  |


#### AuditLogQueryStatus



AuditLogQueryStatus contains the query results and pagination state.



_Appears in:_
- [AuditLogQuery](#auditlogquery)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `results` _Event array_ | Results contains matching audit events, sorted newest-first.<br /><br />Each event follows the Kubernetes audit.Event format with fields like:<br />  verb, user.username, objectRef.\{namespace,resource,name\}, requestReceivedTimestamp,<br />  stageTimestamp, responseStatus.code, requestObject, responseObject<br /><br />Empty results? Try broadening your filter or time range.<br />Full documentation: https://kubernetes.io/docs/reference/config-api/apiserver-audit.v1/ |  |  |
| `continue` _string_ | Continue is the pagination cursor.<br />Non-empty means more results are available - copy this to spec.continue for the next page.<br />Empty means you have all results. |  |  |
| `effectiveStartTime` _string_ | EffectiveStartTime is the actual start time used for this query (RFC3339 format).<br /><br />When you use relative times like "now-7d", this shows the exact timestamp that was<br />calculated. Useful for understanding exactly what time range was queried, especially<br />for auditing, debugging, or recreating queries with absolute timestamps.<br /><br />Example: If you query with startTime="now-7d" at 2025-12-17T12:00:00Z,<br />this will be "2025-12-10T12:00:00Z". |  |  |
| `effectiveEndTime` _string_ | EffectiveEndTime is the actual end time used for this query (RFC3339 format).<br /><br />When you use relative times like "now", this shows the exact timestamp that was<br />calculated. Useful for understanding exactly what time range was queried.<br /><br />Example: If you query with endTime="now" at 2025-12-17T12:00:00Z,<br />this will be "2025-12-17T12:00:00Z". |  |  |


#### FacetResult



FacetResult contains the distinct values for a single facet.



_Appears in:_
- [ActivityFacetQueryStatus](#activityfacetquerystatus)
- [AuditLogFacetsQueryStatus](#auditlogfacetsquerystatus)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `field` _string_ | Field is the field path that was queried. |  |  |
| `values` _[FacetValue](#facetvalue) array_ | Values contains the distinct values and their counts. |  |  |


#### FacetSpec



FacetSpec defines a single facet to retrieve.



_Appears in:_
- [ActivityFacetQuerySpec](#activityfacetqueryspec)
- [AuditLogFacetsQuerySpec](#auditlogfacetsqueryspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `field` _string_ | Field is the activity field path to get distinct values for.<br /><br />Supported fields:<br />  - spec.actor.name: Actor display names<br />  - spec.actor.type: Actor types (user, serviceaccount, controller)<br />  - spec.resource.apiGroup: API groups<br />  - spec.resource.kind: Resource kinds<br />  - spec.resource.namespace: Namespaces<br />  - spec.changeSource: Change sources (human, system) |  |  |
| `limit` _integer_ | Limit is the maximum number of distinct values to return.<br />Default: 20, Maximum: 100. |  |  |


#### FacetTimeRange



FacetTimeRange specifies the time window for facet queries.



_Appears in:_
- [ActivityFacetQuerySpec](#activityfacetqueryspec)
- [AuditLogFacetsQuerySpec](#auditlogfacetsqueryspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `start` _string_ | Start is the beginning of the time window (inclusive).<br />Supports RFC3339 timestamps and relative times (e.g., "now-7d"). |  |  |
| `end` _string_ | End is the end of the time window (exclusive).<br />Supports RFC3339 timestamps and relative times. Defaults to "now". |  |  |


#### FacetValue



FacetValue represents a single distinct value with its occurrence count.



_Appears in:_
- [FacetResult](#facetresult)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `value` _string_ | Value is the distinct field value. |  |  |
| `count` _integer_ | Count is the number of activities with this value. |  |  |




#### PolicyPreviewInput



PolicyPreviewInput contains the sample input for policy testing.



_Appears in:_
- [PolicyPreviewSpec](#policypreviewspec)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `type` _string_ | Type indicates whether this is an audit log or event input.<br />Values: "audit", "event" |  |  |
| `audit` _[Event](#event)_ | Audit contains a sample audit log entry.<br />Required when Type is "audit". |  |  |
| `event` _[RawExtension](https://kubernetes.io/docs/reference/generated/kubernetes-api/v/#rawextension-runtime-pkg)_ | Event contains a sample Kubernetes event.<br />Required when Type is "event".<br />Uses RawExtension to allow flexible event structure. |  |  |


#### PolicyPreviewInputResult



PolicyPreviewInputResult contains the result for a single input.



_Appears in:_
- [PolicyPreviewStatus](#policypreviewstatus)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `inputIndex` _integer_ | InputIndex is the index of this input in spec.inputs (0-based). |  |  |
| `matched` _boolean_ | Matched indicates whether any rule matched this input. |  |  |
| `matchedRuleIndex` _integer_ | MatchedRuleIndex is the index of the rule that matched (0-based).<br />-1 if no rule matched. |  |  |
| `matchedRuleType` _string_ | MatchedRuleType indicates whether the matched rule was an audit or event rule.<br />Empty if no rule matched. |  |  |
| `error` _string_ | Error contains any error message if evaluating this input failed.<br />This could be a CEL compilation error or evaluation error. |  |  |


#### PolicyPreviewSpec



PolicyPreviewSpec defines the policy and inputs to test.



_Appears in:_
- [PolicyPreview](#policypreview)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `policy` _[ActivityPolicySpec](#activitypolicyspec)_ | Policy is the ActivityPolicy spec to test.<br />You can use the full spec from an existing policy or create a new one. |  |  |
| `inputs` _[PolicyPreviewInput](#policypreviewinput) array_ | Inputs contains sample audit logs and/or events to test against the policy.<br />Each input is evaluated independently and produces an Activity if a rule matches.<br />You can mix audit logs and events in the same request. |  |  |


#### PolicyPreviewStatus



PolicyPreviewStatus contains the preview results.



_Appears in:_
- [PolicyPreview](#policypreview)

| Field | Description | Default | Validation |
| --- | --- | --- | --- |
| `activities` _[Activity](#activity) array_ | Activities contains the rendered Activity objects for inputs that matched a rule.<br />The order corresponds to the order of matched inputs (not necessarily the input order).<br />Inputs that don't match any rule are not included here. |  |  |
| `results` _[PolicyPreviewInputResult](#policypreviewinputresult) array_ | Results contains detailed results for each input, in the same order as spec.inputs.<br />Use this to see which inputs matched and any errors that occurred. |  |  |
| `error` _string_ | Error contains a general error message if the preview failed entirely.<br />Individual input errors are reported in results[].error. |  |  |


