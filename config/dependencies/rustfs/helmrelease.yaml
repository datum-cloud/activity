apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: rustfs
  namespace: rustfs-system
spec:
  interval: 5m
  timeout: 10m

  chart:
    spec:
      chart: rustfs
      version: 0.1.x  # Use latest 0.1.x version
      sourceRef:
        kind: HelmRepository
        name: rustfs
        namespace: rustfs-system
      interval: 1h

  # Helm values configuration for RustFS
  values:
    auth:
      accessKey: "myadminuser"
      secretKey: "mysecretpassword"

    # Basic configuration
    config:
      logLevel: "info"

    # Data persistence with 50Gi storage
    dataPersistence:
      size: 50Gi

    # Logs persistence
    logsPersistence:
      size: 5Gi

    # Resource limits
    resources:
      limits:
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 1Gi
  # Install configuration
  install:
    crds: CreateReplace
    createNamespace: false

  # Upgrade configuration
  upgrade:
    crds: CreateReplace

  # Uninstall configuration
  uninstall:
    keepHistory: false
