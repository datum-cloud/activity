apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: activity-system

# Include components for test-infra (migrations only for now)
components:
  - ../../components/rustfs-bucket          # RustFS S3 bucket for ClickHouse cold storage
  - ../../components/clickhouse-database    # ClickHouse database instance
  - ../../components/clickhouse-migrations  # Database schema migrations

# Note: RustFS bucket initialization job will create the S3 bucket on first deployment

# Patches specific to test-infra environment
patches:
  - path: patches/clickhouse-storage-patch.yaml  # Configure ClickHouse to use RustFS

# Additional labels for test-infra environment
commonLabels:
  environment: test-infra
